import{r as o,h as s,F as i}from"./p-e97fde0a.js";import{s as e}from"./p-fab02ef6.js";import"./p-31cd2403.js";import{s as t,c as r,f as l,e as d,b as n}from"./p-e9824b3f.js";import{e as a,s as c,u}from"./p-322d462c.js";import{a as p}from"./p-46b57a87.js";import{l as m,b as v}from"./p-76982419.js";import{a as f}from"./p-9a298389.js";import{a as h,M as y}from"./p-449324ed.js";import{c as j}from"./p-1f60f497.js";import{a as b}from"./p-401e165e.js";import{s as g}from"./p-3aa9debd.js";import{o as k}from"./p-d7296e4c.js";import{c as w}from"./p-d1f5a7ef.js";import"./p-03631502.js";import"./p-93127aa7.js";import"./p-e2d5dc4f.js";import"./p-d3366af3.js";import"./p-830ab1a3.js";import"./p-ec182234.js";import"./p-3f6362a4.js";import"./p-6ec14893.js";import"./p-07b1b1ed.js";import"./p-4194d4cd.js";const _=(o,s,i)=>a("set",((e,t,r)=>{if(e!==o)return;if(Array.isArray(s)){if(s.some((o=>JSON.stringify(t===null||t===void 0?void 0:t[o])!==JSON.stringify(r===null||r===void 0?void 0:r[o])))){return i(t,r)}}if(typeof s==="string"){if(JSON.stringify(t===null||t===void 0?void 0:t[s])===JSON.stringify(r===null||r===void 0?void 0:r[s]))return;return i(t===null||t===void 0?void 0:t[s],r===null||r===void 0?void 0:r[s])}}));const S=":host{display:block}";const J=S;const C=class{constructor(s){o(this,s);this.processorId=undefined;this.method=undefined;this.error=undefined;this.methods=undefined}componentWillLoad(){e.id="mollie";this.fetchMethods();_("checkout",["total_amount","currency","reusabled_payment_method_required","shipping_address"],(()=>this.fetchMethods()))}async fetchMethods(){var o;const s=c.checkout;if(!(s===null||s===void 0?void 0:s.currency)||!(s===null||s===void 0?void 0:s.total_amount))return;try{m("methods");const i=await f({path:b(`surecart/v1/processors/${this.processorId}/payment_method_types`,{amount:s===null||s===void 0?void 0:s.total_amount,country:((o=s===null||s===void 0?void 0:s.shipping_address)===null||o===void 0?void 0:o.country)||"us",currency:s===null||s===void 0?void 0:s.currency,...(s===null||s===void 0?void 0:s.reusable_payment_method_required)?{reusable:s===null||s===void 0?void 0:s.reusable_payment_method_required}:{},per_page:100})});t.methods=(i===null||i===void 0?void 0:i.data)||[]}catch(o){j(o);console.error(o)}finally{v("methods")}}renderLoading(){return s("sc-card",null,s("sc-skeleton",{style:{width:"50%",marginBottom:"0.5em"}}),s("sc-skeleton",{style:{width:"30%",marginBottom:"0.5em"}}),s("sc-skeleton",{style:{width:"60%",marginBottom:"0.5em"}}))}render(){var o,e,t;if(p("methods")&&!((o=r())===null||o===void 0?void 0:o.length)){return this.renderLoading()}if(!((e=c.checkout)===null||e===void 0?void 0:e.currency)){return this.renderLoading()}if(!((t=r())===null||t===void 0?void 0:t.length)){return s("sc-alert",{type:"warning",open:true},wp.i18n.__("No available payment methods","surecart")," ")}const a=l()?"sc-toggles":"div";return s(i,null,s(a,{collapsible:false,theme:"container"},(r()||[]).map((o=>s("sc-payment-method-choice",{"processor-id":"mollie","method-id":o===null||o===void 0?void 0:o.id,key:o===null||o===void 0?void 0:o.id},s("span",{slot:"summary",class:"sc-payment-toggle-summary"},!!(o===null||o===void 0?void 0:o.image)&&s("img",{src:o===null||o===void 0?void 0:o.image,"aria-hidden":"true"}),s("span",null,o===null||o===void 0?void 0:o.description)),s("sc-card",null,s("sc-payment-selected",{label:wp.i18n.sprintf(wp.i18n.__("%s selected for check out.","surecart"),o===null||o===void 0?void 0:o.description)},!!(o===null||o===void 0?void 0:o.image)&&s("img",{slot:"icon",src:o===null||o===void 0?void 0:o.image,style:{width:"32px"}}),wp.i18n.__("Another step will appear after submitting your order to complete your purchase details.","surecart")))))),s(h,{processor:d("mock")}),s(y,{methods:n()})),!!p("methods")&&s("sc-block-ui",{class:"busy-block-ui","z-index":9,style:{"--sc-block-ui-opacity":"0.4"}}))}};C.style=J;const N=class{constructor(s){o(this,s)}componentWillLoad(){this.unlistenToFormState=k("formState",(()=>{if("paying"===w()){this.confirm()}}))}disconnectedCallback(){this.unlistenToFormState()}async confirm(){var o,s,i,t;if((e===null||e===void 0?void 0:e.id)!=="paystack")return;if(!((s=(o=c===null||c===void 0?void 0:c.checkout)===null||o===void 0?void 0:o.payment_intent)===null||s===void 0?void 0:s.processor_data.paystack))return;if(((i=c===null||c===void 0?void 0:c.checkout)===null||i===void 0?void 0:i.status)==="paid")return;try{const{public_key:o,access_code:s}=(t=c===null||c===void 0?void 0:c.checkout)===null||t===void 0?void 0:t.payment_intent.processor_data.paystack;if(!o||!s){j({message:wp.i18n.sprintf(wp.i18n.__("Payment gateway configuration incomplete. Please ensure Paystack is properly configured for transactions.","surecart"))});return}const i=new g;await i.newTransaction({key:o,accessCode:s,onSuccess:async o=>{if((o===null||o===void 0?void 0:o.status)!=="success"){throw{message:wp.i18n.sprintf(wp.i18n.__("Paystack transaction could not be finished. Status: %s","surecart"),o===null||o===void 0?void 0:o.status)}}return u("PAID")},onClose:()=>u("REJECT")})}catch(o){j(o);console.error(o);u("REJECT")}}};export{C as sc_checkout_mollie_payment,N as sc_checkout_paystack_payment_provider};
//# sourceMappingURL=p-658d5fbe.entry.js.map